@let legislature = bodyLegislature$ | async;
@if (legislature) {
  <h2>{{ legislature.title }}</h2>

  @let lowerChamber = bodyLowerChamber$ | async;
  @let upperChamber = bodyUpperChamber$ | async;

  <ng-template #bodyTemplate let-body="body">
    @if (body) {
      <h2>{{ body.name }}</h2>
      <div class="flex-horizontal-centered">
        @let term = body.currentTerm;
        @if (term) {
          @let fractions = term.fractions;
          @if (fractions && fractions.length > 0) {
            <pt-hemisphere-diagram [fractions]="fractions"></pt-hemisphere-diagram>
            <table class="compact-table">
              <thead>
              <th class="text-left" colspan="2">Party</th>
              <th class="text-right">Seats</th>
              </thead>
              <tbody>
                @for (fraction of term.fractions || []; track fraction.id) {
                  <tr>
                    <td>
                      <pt-color-box [color]="fraction.party.color"/>
                    </td>
                    <td>
                      {{ fraction.party.name }}
                    </td>
                    <td class="text-right">
                      {{ fraction.seats }}
                    </td>
                  </tr>
                }
              </tbody>
              <tfoot>
              <tr class="border-top">
                <td colspan="2"><b>Total</b></td>
                <td class="text-right">{{ term.seats }}</td>
              </tr>
              </tfoot>
            </table>
          }
        }
      </div>
    }
  </ng-template>

  <ng-container [ngTemplateOutlet]="bodyTemplate" [ngTemplateOutletContext]="{body: lowerChamber}"></ng-container>
  <ng-container [ngTemplateOutlet]="bodyTemplate" [ngTemplateOutletContext]="{body: upperChamber}"></ng-container>
}
